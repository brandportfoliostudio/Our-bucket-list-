<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Our Bucket List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@300;400;500&family=Patrick+Hand&display=swap" rel="stylesheet">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
:root{
  --bg:#f6f5f3;
  --surface:#ffffff;
  --ink:#0f0f0f;
  --muted:#777;
  --accent:#d6a6b3;
  --radius:22px;
  --ease:cubic-bezier(.22,1,.36,1);
}

*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  font-family:Inter,sans-serif;
  color:var(--ink);
  overflow-x:hidden;
}

/* HEADER */
header{
  padding:70px 8vw 30px;
}
h1{
  font-family:Anton;
  font-size:clamp(2.6rem,6vw,4.6rem);
  letter-spacing:.06em;
  margin:0;
}
header p{
  color:var(--muted);
  max-width:520px;
}

/* SEARCH */
.search-wrap{
  margin-top:26px;
}
.search{
  width:100%;
  max-width:420px;
  padding:14px 18px;
  border-radius:40px;
  border:none;
  font-size:1rem;
  box-shadow:0 18px 40px rgba(0,0,0,.08);
}

/* BUCKET */
.bucket-stage{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:flex-end;
  z-index:5;
}
.bucket{
  width:420px;
  height:340px;
  background:linear-gradient(#ddb4bd,#c58a9f);
  border-radius:0 0 70px 70px;
  transform:translateY(100%);
  animation:rise 1.8s var(--ease) forwards;
  cursor:pointer;
  position:relative;
  box-shadow:0 40px 120px rgba(0,0,0,.25);
}
@keyframes rise{to{transform:translateY(48%)}}
.bucket::before{
  content:"";
  position:absolute;
  top:-56px;
  left:-36px;
  right:-36px;
  height:110px;
  border:12px solid #c58a9f;
  border-bottom:none;
  border-radius:120px 120px 0 0;
}
.bucket-label{
  position:absolute;
  bottom:110px;
  width:100%;
  text-align:center;
  font-family:Anton;
  color:white;
  letter-spacing:.1em;
}

/* PAPER BURST */
.paper{
  position:fixed;
  width:130px;
  height:80px;
  background:#fffdf9;
  padding:10px;
  font-family:'Patrick Hand';
  font-size:14px;
  border-radius:6px;
  box-shadow:0 18px 40px rgba(0,0,0,.25);
  animation:fly 1.8s var(--ease) forwards;
  z-index:4;
}
@keyframes fly{
  to{
    transform:
      translate(calc(-260px + 520px * var(--x)),
                calc(-520px - 260px * var(--y)))
      rotate(calc(-60deg + 120deg * var(--r)));
    opacity:0;
  }
}

/* CONTENT */
main{
  display:none;
  padding:20px 8vw 120px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:26px;
}

/* CARD */
.card{
  background:rgba(255,255,255,.88);
  backdrop-filter:blur(12px);
  border-radius:var(--radius);
  padding:22px;
  box-shadow:0 28px 80px rgba(0,0,0,.12);
  animation:cardIn .7s var(--ease) both;
}
@keyframes cardIn{
  from{opacity:0;transform:translateY(40px)}
}
.card textarea{
  width:100%;
  border:none;
  resize:none;
  background:transparent;
  font-size:1rem;
  font-family:Inter;
}
.card-actions{
  display:flex;
  gap:10px;
  margin-top:12px;
}
.card-actions button{
  border:none;
  background:var(--ink);
  color:white;
  padding:8px 14px;
  border-radius:20px;
  font-size:.75rem;
  cursor:pointer;
}

/* MAP MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:20;
}
.modal-box{
  width:min(92vw,640px);
  background:white;
  border-radius:26px;
  padding:16px;
  animation:modalIn .6s var(--ease);
}
@keyframes modalIn{
  from{opacity:0;transform:scale(.92)}
}
.modal-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:6px 6px 12px;
}
.modal-header input{
  flex:1;
  padding:10px 14px;
  border-radius:20px;
  border:1px solid #ddd;
}
.close{
  margin-left:10px;
  border:none;
  background:#eee;
  border-radius:50%;
  width:36px;
  height:36px;
  cursor:pointer;
}
#map{
  height:360px;
  border-radius:18px;
  margin-top:10px;
}
</style>
</head>

<body>

<header>
  <h1>Our Bucket List</h1>
  <p>Dreams, memories and places we‚Äôll reach together.</p>

  <div class="search-wrap">
    <input class="search" id="search" placeholder="Search dreams‚Ä¶">
  </div>
</header>

<div class="bucket-stage">
  <div class="bucket" id="bucket">
    <div class="bucket-label">OPEN</div>
  </div>
</div>

<main id="content">
  <div class="grid" id="grid"></div>
</main>

<!-- MAP -->
<div class="modal" id="modal">
  <div class="modal-box">
    <div class="modal-header">
      <input id="placeSearch" placeholder="Search location‚Ä¶">
      <button class="close" onclick="closeMap()">‚úï</button>
    </div>
    <div id="map"></div>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const defaultItems = [
 "See her in a wedding gown.","Travel the world together","Move abroad and settle",
 "Capri ‚Äì our dream place","Bioluminescence","Flying lantern festival",
 "Secret gift on her 40th birthday","Buy a caravan","Open a caf√© together",
 "Ladakh road trip","Camping under night sky","Horse riding",
 "Speed boat at sunset","Sky diving","Cycling in Switzerland",
 "Gift her dream digicam","Fireworks together","Buy a yacht",
 "BMW i7 or M5","Adopt a child","Disneyland","Hot air balloon with kids",
 "Mauritius underwater waterfall","Sydney New Year fireworks",
 "First anniversary giving back","Escape room date","Copacabana New Year",
 "Dive with whales","Jet skiing Dubai","Sky diving Dubai",
 "Marry her under open sky","F1 together","Matching rings in Osaka",
 "Kiss Bridge ‚Äì Phu Quoc"
];

let items = JSON.parse(localStorage.getItem("bucket")) ||
  defaultItems.map(t=>({text:t,lat:null,lng:null}));

const grid=document.getElementById("grid");
const search=document.getElementById("search");

function render(){
  grid.innerHTML="";
  items
    .filter(i=>i.text.toLowerCase().includes(search.value.toLowerCase()))
    .forEach((item,i)=>{
      const c=document.createElement("div");
      c.className="card";
      c.innerHTML=`
        <textarea oninput="edit(${i},this.value)">${item.text}</textarea>
        <div class="card-actions">
          <button onclick="openMap(${i})">üìç ${item.lat?"View":"Set"} Location</button>
        </div>
      `;
      grid.appendChild(c);
    });
  localStorage.setItem("bucket",JSON.stringify(items));
}

function edit(i,v){items[i].text=v;render()}
search.oninput=render;

/* MAP */
let map,marker,active;
function openMap(i){
  active=i;
  document.getElementById("modal").style.display="flex";
  setTimeout(()=>{
    if(!map){
      map=L.map("map").setView([20,0],2);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
      map.on("click",e=>{
        if(marker) marker.remove();
        marker=L.marker(e.latlng).addTo(map);
        items[active].lat=e.latlng.lat;
        items[active].lng=e.latlng.lng;
        localStorage.setItem("bucket",JSON.stringify(items));
      });
    }
    if(items[i].lat){
      map.setView([items[i].lat,items[i].lng],6);
      marker=L.marker([items[i].lat,items[i].lng]).addTo(map);
    }
  },200);
}
function closeMap(){
  document.getElementById("modal").style.display="none";
}

/* LOCATION SEARCH */
document.getElementById("placeSearch").addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${e.target.value}`)
      .then(r=>r.json()).then(d=>{
        if(d[0]){
          map.setView([d[0].lat,d[0].lon],6);
        }
      });
  }
});

/* BUCKET OPEN */
function burst(){
  for(let i=0;i<12;i++){
    const p=document.createElement("div");
    p.className="paper";
    p.innerText="Dream";
    p.style.left="50%";
    p.style.bottom="38%";
    p.style.setProperty("--x",Math.random());
    p.style.setProperty("--y",Math.random());
    p.style.setProperty("--r",Math.random());
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),1800);
  }
}

document.getElementById("bucket").onclick=()=>{
  burst();
  document.querySelector(".bucket-stage").remove();
  document.getElementById("content").style.display="block";
  render();
};
</script>

</body>
</html>
