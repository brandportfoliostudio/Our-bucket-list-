<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Our Bucket List</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@300;400;500&family=Patrick+Hand&display=swap" rel="stylesheet">

<!-- Leaflet Map -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
:root{
  --bg:#f5f4f2;
  --surface:#ffffff;
  --ink:#111;
  --muted:#666;
  --accent:#d8a7b1;
  --ease:cubic-bezier(.22,1,.36,1);
}

*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  font-family:Inter,sans-serif;
  color:var(--ink);
}

/* ---------- HEADER ---------- */
header{
  padding:64px 8vw 24px;
}
.title{
  font-family:Anton;
  font-size:clamp(2.5rem,6vw,4.5rem);
  letter-spacing:.04em;
}
.subtitle{
  max-width:520px;
  color:var(--muted);
  margin-top:10px;
}

/* ---------- BUCKET ---------- */
.bucket-stage{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:flex-end;
  z-index:5;
}
.bucket{
  width:420px;
  height:340px;
  background:linear-gradient(#ddb4bd,#c58a9f);
  border-radius:0 0 70px 70px;
  transform:translateY(100%);
  animation:rise 1.8s var(--ease) forwards;
  cursor:pointer;
  position:relative;
  box-shadow:0 40px 120px rgba(0,0,0,.25);
}
@keyframes rise{to{transform:translateY(48%)}}
.bucket::before{
  content:"";
  position:absolute;
  top:-56px;
  left:-36px;
  right:-36px;
  height:110px;
  border:12px solid #c58a9f;
  border-bottom:none;
  border-radius:120px 120px 0 0;
}
.bucket-label{
  position:absolute;
  bottom:110px;
  width:100%;
  text-align:center;
  font-family:Anton;
  color:white;
  letter-spacing:.08em;
}

/* ---------- PAPER ---------- */
.paper{
  position:fixed;
  width:130px;
  height:80px;
  background:#fffdf9;
  padding:10px;
  font-family:'Patrick Hand',cursive;
  font-size:14px;
  border-radius:6px;
  box-shadow:0 18px 40px rgba(0,0,0,.25);
  animation:fly 1.8s var(--ease) forwards;
  z-index:4;
}
@keyframes fly{
  to{
    transform:
      translate(calc(-260px + 520px * var(--x)),
                calc(-520px - 260px * var(--y)))
      rotate(calc(-60deg + 120deg * var(--r)));
    opacity:0;
  }
}

/* ---------- CONTENT ---------- */
main{
  display:none;
  padding:40px 8vw 120px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:28px;
}

/* ---------- CARD ---------- */
.card{
  background:rgba(255,255,255,.85);
  backdrop-filter:blur(10px);
  border-radius:26px;
  padding:22px;
  box-shadow:0 30px 80px rgba(0,0,0,.12);
  animation:cardIn .8s var(--ease) both;
}
@keyframes cardIn{
  from{opacity:0;transform:translateY(50px)}
}
.card textarea{
  width:100%;
  border:none;
  resize:none;
  background:transparent;
  font-family:Inter;
  font-size:1rem;
}
.card-actions{
  display:flex;
  gap:12px;
  margin-top:12px;
}
.card-actions button{
  border:none;
  background:var(--ink);
  color:white;
  padding:8px 14px;
  border-radius:20px;
  font-size:.75rem;
  cursor:pointer;
}

/* ---------- MAP MODAL ---------- */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:20;
}
.modal-box{
  width:min(90vw,600px);
  background:white;
  border-radius:20px;
  padding:16px;
}
#map{
  height:360px;
  border-radius:14px;
}
.close{
  margin-top:12px;
  background:var(--accent);
  border:none;
  padding:10px 20px;
  border-radius:20px;
  color:white;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <div class="title">Our Bucket List</div>
  <div class="subtitle">Dreams mapped across the world.</div>
</header>

<div class="bucket-stage">
  <div class="bucket" id="bucket">
    <div class="bucket-label">OPEN</div>
  </div>
</div>

<main id="content">
  <div class="grid" id="grid"></div>
</main>

<!-- MAP MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <div id="map"></div>
    <button class="close" onclick="closeMap()">Done</button>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const papers=["Capri","Wedding","Forever","Ladakh","Cafe","World","Us"];

let items=JSON.parse(localStorage.getItem("dreams"))||[
  {text:"Capri ‚Äì our dream place.",lat:null,lng:null},
  {text:"Marry her under open sky.",lat:null,lng:null},
  {text:"Ladakh road trip.",lat:null,lng:null}
];

const grid=document.getElementById("grid");
let map,marker,activeIndex;

function render(){
  grid.innerHTML="";
  items.forEach((item,i)=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <textarea oninput="edit(${i},this.value)">${item.text}</textarea>
      <div class="card-actions">
        <button onclick="openMap(${i})">üìç Set Location</button>
        ${item.lat?`<button onclick="openMap(${i})">üåç View</button>`:""}
      </div>
    `;
    grid.appendChild(c);
  });
  localStorage.setItem("dreams",JSON.stringify(items));
}

function edit(i,v){items[i].text=v;render()}

/* MAP */
function openMap(i){
  activeIndex=i;
  document.getElementById("modal").style.display="flex";

  setTimeout(()=>{
    if(!map){
      map=L.map("map").setView([20,0],2);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
      map.on("click",e=>{
        if(marker) marker.remove();
        marker=L.marker(e.latlng).addTo(map);
        items[activeIndex].lat=e.latlng.lat;
        items[activeIndex].lng=e.latlng.lng;
        localStorage.setItem("dreams",JSON.stringify(items));
      });
    }
    if(items[i].lat){
      map.setView([items[i].lat,items[i].lng],6);
      marker=L.marker([items[i].lat,items[i].lng]).addTo(map);
    }
  },200);
}

function closeMap(){
  document.getElementById("modal").style.display="none";
}

/* PAPER + OPEN */
function burst(){
  for(let i=0;i<12;i++){
    const p=document.createElement("div");
    p.className="paper";
    p.innerText=papers[Math.floor(Math.random()*papers.length)];
    p.style.left="50%";
    p.style.bottom="38%";
    p.style.setProperty("--x",Math.random());
    p.style.setProperty("--y",Math.random());
    p.style.setProperty("--r",Math.random());
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),1800);
  }
}

document.getElementById("bucket").onclick=()=>{
  burst();
  document.querySelector(".bucket-stage").remove();
  document.getElementById("content").style.display="block";
  render();
};
</script>

</body>
</html>
